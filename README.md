# 18-03-2023: Uncovering zgRAT

## Introduzione
In questa analisi di malware, si esamina zgRAT, che è stato rilevato il 18-03-2023 su un dispositivo USB (NDA).

L'obiettivo di questa analisi è di fornire una comprensione dettagliata del malware e del suo modo di diffusione.

## Dettagli files ritrovati sul dispositivo USB
- **Nome del file:** "E (1GB).lnk"
- **MD5 Hash del file:** fb794ee46c626782ada13d44764be0a7
- **Dimensioni del file:** 1.040 byte
---
- **Nome del file:** "explorer.ps1"
- **MD5 Hash del file:** fbf922c2cf05bce793f80af24f75b84b
- **Dimensioni del file:** 1.687 byte

## Stage_0
Il file "E (1GB).lnk" è un bootloader per il file "explorer.ps1" e contiene il seguente comando:

```C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -windowstyle hidden -NoProfile -nologo -ExecutionPolicy ByPass -File explorer.ps1```

## Stage_1
Il file "explorer.ps1" contiene una stringa codifica in Base64.

Questa stringa è altro codice powershell che permette allo script di riceve un ulteriore stage sfruttando AES e Vimeo.

## Stage_2
Scarica il payload finale, ovvero zgRAT

## Analisi automatica del sample
Bazaar: https://bazaar.abuse.ch/sample/8a492973b12f84f49c52216d8c29755597f0b92a02311286b1f75ef5c265c30d/

Cape: https://www.capesandbox.com/analysis/375429/
